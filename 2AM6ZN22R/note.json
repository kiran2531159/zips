{
  "paragraphs": [
    {
      "text": "%md this is the example monitoring cluster resource inside of zeppelin (without any cluster monitoring software installed) by using spark",
      "dateUpdated": "2015-10-21 16:05:07.000",
      "config": {
        "colWidth": 12.0,
        "tableHide": false,
        "editorHide": true,
        "editorMode": "ace/mode/markdown",
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "keys": [],
              "values": [],
              "groups": [],
              "scatter": {}
            }
          }
        ]
      },
      "settings": {
        "params": {
          "path": "hdfs://commander1.nflabs.com:8020/data/bank/*"
        },
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cp\u003ethis is the example monitoring cluster resource inside of zeppelin (without any cluster monitoring software installed) by using spark\u003c/p\u003e\n"
          }
        ]
      },
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cp\u003ethis is the example monitoring cluster resource inside of zeppelin (without any cluster monitoring software installed) by using spark\u003c/p\u003e\n"
      },
      "apps": [],
      "jobName": "paragraph_1427960510046_1748056322",
      "id": "20150402-164150_2096298974",
      "dateCreated": "2015-04-02 16:41:50.000",
      "dateStarted": "2015-04-08 13:21:39.000",
      "dateFinished": "2015-04-08 13:21:39.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// define cluster monitoring function.\n// requires mpstat command installed in all spark workers.\n\nimport sys.process._\n\ndef getClusterCpu \u003d {\n    sc.setLocalProperty(\"spark.scheduler.pool\", \"fair\");\n    val clusterCpu \u003d sc.parallelize(1 to 10).map{s\u003d\u003e\n        ((\"hostname\" !!).replace(\"\\n\", \"\"), \"mpstat 1 1\" !!)\n    }.map{ s \u003d\u003e\n        (s._1, ((100.0 - s._2.split(\"\\n\")(3).split(\"\\\\s+\")(10).toDouble)*100).toInt.toDouble / 100)\n    }.reduceByKey((a,b) \u003d\u003e scala.math.max(a,b)).collect.sortWith(_._1 \u003c _._1)\n    z.angularBind(\"cpuUsage\", clusterCpu)\n}",
      "user": "anonymous",
      "dateUpdated": "2018-10-04 13:55:26.852",
      "config": {
        "colWidth": 12.0,
        "editorMode": "ace/mode/scala",
        "editorHide": false,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "keys": [],
              "values": [],
              "groups": [],
              "scatter": {}
            }
          }
        ],
        "fontSize": 9.0,
        "enabled": true,
        "editorSetting": {}
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import sys.process._\nwarning: there were 2 feature warning(s); re-run with -feature for details\ngetClusterCpu: Unit\n"
      },
      "apps": [],
      "jobName": "paragraph_1427960525243_491481738",
      "id": "20150402-164205_360658609",
      "dateCreated": "2015-04-02 16:42:05.000",
      "dateStarted": "2018-10-04 13:55:27.069",
      "dateFinished": "2018-10-04 13:55:56.325",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// start monitoring. once a second.\nval t \u003d new java.util.Timer()\nval task \u003d new java.util.TimerTask {\n  def run() \u003d getClusterCpu\n}\nt.schedule(task, 1000L, 1000L)",
      "user": "anonymous",
      "dateUpdated": "2018-10-04 13:56:02.811",
      "config": {
        "colWidth": 12.0,
        "editorHide": false,
        "tableHide": false,
        "editorMode": "ace/mode/scala",
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "keys": [],
              "values": [],
              "groups": [],
              "scatter": {}
            }
          }
        ],
        "fontSize": 9.0,
        "enabled": true,
        "editorSetting": {}
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "t: java.util.Timer \u003d java.util.Timer@15c32912\ntask: java.util.TimerTask \u003d $iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$anon$1@1f362cfe\n"
      },
      "apps": [],
      "jobName": "paragraph_1428463640180_951507321",
      "id": "20150408-122720_1669705867",
      "dateCreated": "2015-04-08 12:27:20.000",
      "dateStarted": "2018-10-04 13:56:02.949",
      "dateFinished": "2018-10-04 13:56:05.667",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%angular\nCluster CPU Usage\n\n\u003ctable class\u003d\"table\"\u003e\n    \u003ctr\u003e\n        \u003cth style\u003d\"width:200px\"\u003eHost\u003c/th\u003e\n        \u003cth style\u003d\"width:100px\"\u003eCpu\u003c/th\u003e\n        \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr ng-repeat\u003d\"info in cpuUsage\"\u003e\n        \u003ctd\u003e{{info._1}}\u003c/td\u003e\n        \u003ctd\u003e{{info._2}}\u003c/td\u003e\n        \u003ctd\u003e\n            \u003cdiv class\u003d\"progress\"\u003e\n              \u003cdiv class\u003d\"progress-bar\" role\u003d\"progressbar\" aria-valuenow\u003d\"{{info._2}}\" aria-valuemin\u003d\"0\" aria-valuemax\u003d\"100\" style\u003d\"width: {{info._2}}%;\"\u003e\n                \u003cspan class\u003d\"sr-only\"\u003e{{info._2}}%\u003c/span\u003e\n              \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\n",
      "dateUpdated": "2015-11-02 12:02:10.000",
      "config": {
        "colWidth": 6.0,
        "editorHide": true,
        "editorMode": "ace/mode/scala",
        "tableHide": false,
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "keys": [],
              "values": [],
              "groups": [],
              "scatter": {}
            }
          }
        ]
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "ANGULAR",
            "data": "Cluster CPU Usage\n\n\u003ctable class\u003d\"table\"\u003e\n    \u003ctr\u003e\n        \u003cth style\u003d\"width:200px\"\u003eHost\u003c/th\u003e\n        \u003cth style\u003d\"width:100px\"\u003eCpu\u003c/th\u003e\n        \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr ng-repeat\u003d\"info in cpuUsage\"\u003e\n        \u003ctd\u003e{{info._1}}\u003c/td\u003e\n        \u003ctd\u003e{{info._2}}\u003c/td\u003e\n        \u003ctd\u003e\n            \u003cdiv class\u003d\"progress\"\u003e\n              \u003cdiv class\u003d\"progress-bar\" role\u003d\"progressbar\" aria-valuenow\u003d\"{{info._2}}\" aria-valuemin\u003d\"0\" aria-valuemax\u003d\"100\" style\u003d\"width: {{info._2}}%;\"\u003e\n                \u003cspan class\u003d\"sr-only\"\u003e{{info._2}}%\u003c/span\u003e\n              \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\n"
          }
        ]
      },
      "result": {
        "code": "SUCCESS",
        "type": "ANGULAR",
        "msg": "Cluster CPU Usage\n\n\u003ctable class\u003d\"table\"\u003e\n    \u003ctr\u003e\n        \u003cth style\u003d\"width:200px\"\u003eHost\u003c/th\u003e\n        \u003cth style\u003d\"width:100px\"\u003eCpu\u003c/th\u003e\n        \u003cth\u003e\u003c/th\u003e\n    \u003c/tr\u003e\n    \u003ctr ng-repeat\u003d\"info in cpuUsage\"\u003e\n        \u003ctd\u003e{{info._1}}\u003c/td\u003e\n        \u003ctd\u003e{{info._2}}\u003c/td\u003e\n        \u003ctd\u003e\n            \u003cdiv class\u003d\"progress\"\u003e\n              \u003cdiv class\u003d\"progress-bar\" role\u003d\"progressbar\" aria-valuenow\u003d\"{{info._2}}\" aria-valuemin\u003d\"0\" aria-valuemax\u003d\"100\" style\u003d\"width: {{info._2}}%;\"\u003e\n                \u003cspan class\u003d\"sr-only\"\u003e{{info._2}}%\u003c/span\u003e\n              \u003c/div\u003e\n            \u003c/div\u003e\n        \u003c/td\u003e\n    \u003c/tr\u003e\n\u003c/table\u003e\n"
      },
      "apps": [],
      "jobName": "paragraph_1428463770087_574654258",
      "id": "20150408-122930_167445471",
      "dateCreated": "2015-04-08 12:29:30.000",
      "dateStarted": "2015-09-02 17:52:14.000",
      "dateFinished": "2015-09-02 17:52:15.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// let\u0027s load some data and see how it monitors\nval data \u003d sc.parallelize(1 to 1000).map{s\u003d\u003e\n    (1 to 2000000).foreach{new java.util.Random(_).nextInt}\n}",
      "dateUpdated": "2015-11-02 12:02:44.000",
      "config": {
        "colWidth": 6.0,
        "editorHide": false,
        "tableHide": false,
        "editorMode": "ace/mode/scala",
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "keys": [],
              "values": [],
              "groups": [],
              "scatter": {}
            }
          }
        ]
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "data: org.apache.spark.rdd.RDD[Unit] \u003d MapPartitionsRDD[17] at map at \u003cconsole\u003e:27\n"
          }
        ]
      },
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "data: org.apache.spark.rdd.RDD[Unit] \u003d MapPartitionsRDD[17] at map at \u003cconsole\u003e:27\n"
      },
      "apps": [],
      "jobName": "paragraph_1428466345932_-1960964708",
      "id": "20150408-131225_301120032",
      "dateCreated": "2015-04-08 13:12:25.000",
      "dateStarted": "2015-11-02 12:02:44.000",
      "dateFinished": "2015-11-02 12:02:44.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "data.count",
      "dateUpdated": "2015-11-02 12:02:46.000",
      "config": {
        "colWidth": 6.0,
        "editorMode": "ace/mode/scala",
        "results": [
          {
            "graph": {
              "mode": "table",
              "height": 300.0,
              "optionOpen": false,
              "keys": [],
              "values": [],
              "groups": [],
              "scatter": {}
            }
          }
        ]
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "res10: Long \u003d 1000\n"
          }
        ]
      },
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "res10: Long \u003d 1000\n"
      },
      "apps": [],
      "jobName": "paragraph_1428466482867_-637661643",
      "id": "20150408-131442_410635590",
      "dateCreated": "2015-04-08 13:14:42.000",
      "dateStarted": "2015-11-02 12:02:46.000",
      "dateFinished": "2015-11-02 12:03:05.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1428466965613_-1225480818",
      "id": "20150408-132245_1823749070",
      "dateCreated": "2015-04-08 13:22:45.000",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "t.cancel",
      "dateUpdated": "2015-11-02 12:04:11.000",
      "config": {
        "colWidth": 12.0,
        "results": []
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": []
      },
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": ""
      },
      "apps": [],
      "jobName": "paragraph_1428464324654_82557126",
      "id": "20150408-123844_673822021",
      "dateCreated": "2015-04-08 12:38:44.000",
      "dateStarted": "2015-11-02 12:04:11.000",
      "dateFinished": "2015-11-02 12:04:12.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": " ",
      "dateUpdated": "2015-11-02 12:09:08.000",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "result": {
        "code": "SUCCESS",
        "type": "TEXT"
      },
      "apps": [],
      "jobName": "paragraph_1428500392852_339436039",
      "id": "20150408-223952_953547320",
      "dateCreated": "2015-04-08 22:39:52.000",
      "dateStarted": "2015-11-02 12:09:08.000",
      "dateFinished": "2015-11-02 12:09:08.000",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "",
      "dateUpdated": "2015-11-02 12:07:52.000",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "apps": [],
      "jobName": "paragraph_1446433603913_-2041025150",
      "id": "20151102-120643_1189689063",
      "dateCreated": "2015-11-02 12:06:43.000",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Cluster resource monitoring",
  "id": "2AM6ZN22R",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {
    "angular:shared_process": [],
    "spark:shared_process": []
  },
  "config": {
    "looknfeel": "default",
    "isZeppelinNotebookCronEnable": true
  },
  "info": {}
}